{% extends 'base.html' %}

{% block title %}Detalii temă - {{ homework.titlu }}{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="row g-4">
    <div class="col-lg-8">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
          <h5 class="mb-0">{{ homework.titlu }}</h5>
          <span class="badge bg-light text-dark">{{ homework.subject.nume }}</span>
        </div>
        <div class="card-body">
          {% if homework.descriere %}
          <p class="mb-3">{{ homework.descriere }}</p>
          {% endif %}

          <div class="row g-3">
            <div class="col-md-4">
              <div class="small text-muted">Data primirii</div>
              <div><strong>{{ homework.data_primita|date:'d.m.Y' }}</strong></div>
            </div>
            <div class="col-md-4">
              <div class="small text-muted">Deadline</div>
              <div><strong>{{ homework.deadline|date:'d.m.Y' }}</strong></div>
            </div>
            <div class="col-md-4">
              <div class="small text-muted">Prioritate</div>
              <div><strong>{{ homework.get_prioritate_display }}</strong></div>
            </div>
          </div>
        </div>
      </div>

      {% if files %}
      <div class="card mt-3">
        <div class="card-header">
          <h6 class="mb-0"><i class="fas fa-images me-2"></i>Fișiere / Poze</h6>
        </div>
        <div class="card-body">
          <div class="row g-3">
            {% for f in files %}
            <div class="col-6 col-md-4 col-lg-3">
              <div class="border rounded p-2 text-center">
                {% if f.tip == 'imagine' %}
                <img src="{{ f.fisier.url }}" class="img-fluid rounded" alt="{{ f.nume }}">
                {% else %}
                <i class="fas fa-file fa-3x text-muted"></i>
                <div class="small mt-2">{{ f.nume }}</div>
                {% endif %}
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
      {% endif %}
    </div>

    <div class="col-lg-4">
      <div class="card">
        <div class="card-header">
          <h6 class="mb-0"><i class="fas fa-tasks me-2"></i>Status</h6>
        </div>
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <div class="small text-muted">Progres</div>
            <div class="small"><strong>{{ homework.progres }}%</strong></div>
          </div>
          <div class="progress mb-3" style="height: 6px;">
            <div class="progress-bar bg-success" style="width: {{ homework.progres }}%"></div>
          </div>

          {% if not homework.finalizata %}
          <form method="post" action="{% url 'homework:update_progress' homework.id %}">
            {% csrf_token %}
            <div class="input-group input-group-sm mb-3">
              <input type="number" class="form-control" name="progress" value="{{ homework.progres }}" min="0" max="100">
              <button class="btn btn-outline-primary" type="submit">Actualizează</button>
            </div>
          </form>
          <form method="post" action="{% url 'homework:toggle_complete' homework.id %}">
            {% csrf_token %}
            <button class="btn btn-success w-100">Marchează finalizată</button>
          </form>
          {% else %}
          <div class="alert alert-success">Temă finalizată la {{ homework.data_finalizare|date:'d.m.Y H:i' }}</div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

 
